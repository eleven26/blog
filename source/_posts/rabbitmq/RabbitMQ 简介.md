---
title: RabbitMQ 简介
date: 2019-11-08 19:52:00
tags: [RabbitMQ]
---

## 什么是消息中间件

消息（Message）是指在应用间传送的数据。消息可以非常简单，比如只包含文本字符串、JSON 等，也可以很复杂，比如内嵌对象。

消息队列中间件（Message Queue Middleware，简称为 MQ）是指利用高效可靠的消息传递机制进行与平台无关的数据交流，
并基于数据通信来进行分布式系统集成。通过提供消息传递和消息排队模型，它可以在分布式环境下扩展进程间的通信。

消息队列中间件，也可以成为消息队列或者消息中间件。它一般有两种传递模式：点对点模式和发布/订阅模式。
点对点模式是基于队列的，消息生产者发送消息到队列，消息消费者从队列中接收消息，队列的存在使得消息的异步传输成为可能。
发布订阅模式定义了如何向一个内容节点发布和订阅消息，这个内容节点称为主题（topic），主题可以认为是消息传递的中介，
消息发布者将消息发布到某个主题，而消息订阅者则从主题中订阅消息。主题使得消息的订阅者与消息的发布者互相保持独立，
不需要进行接触即可保证消息的传递，发布/订阅模式在消息的一对多广播时采用。

面向消息的中间件（简称为 MOM，Message Oriented Middleware）提供了以松散耦合的灵活方式集成应用程序的一种机制。
它们提供了基于存储和转发的应用程序之间的异步数据传送，即应用程序彼此不直接通信，而是与作为中介的消息中间件通信。
消息中间件提供了有保证的消息发送，应用程序开发人员无需了解远程过程调用（RPC）和网络通信协议的细节。

消息中间件适用于需要可靠的数据传送的分布式环境。采用消息中间件的系统中，不同的对象之间通过传递消息来激活对方的事件，以完成相应的操作。
发送者将消息发送给消息服务器，消息服务器将消息放在若干队列中，在合适的时候再将消息转发给接收者。
消息中间件能在不同平台之间通信，它常被用来屏蔽各种平台及协议之间的特性，实现应用程序之间的协同，
其优点在于能够在客户和服务器之间提供同步和异步的连接，并且在任何时刻都可以将消息进行传送或者存储转发，
这也是它远比远程过程调用更进步的原因。


## 消息中间件的作用

消息中间件凭借其独到的特性，在不同的应用场景下可以展现不同的作用。总的来说，消息中间件的作用可以概括如下：

* 解耦：在项目启动之初来预测将来会碰到什么需求是及其困难的。消息中间件在处理过程中间插入了一个隐含的、基于数据的接口层，
两边的处理过程都要实现这一接口，这允许你独立地扩展或修改两边的处理过程，只要确保它们遵守同样的接口约束即可。

* 冗余（存储）：有些情况下，处理数据的过程会失败。消息中间件可以把数据进行持久化直到它们已经被完全处理，
通过这一方式规避了数据丢失风险。在把一个消息从消息中间件删除之前，需要你的处理系统明确地指出该消息已经被处理完成，
从而确保你的数据被安全地保存直到你使用完毕。

* 扩展性：因为消息中间件解耦了应用地处理过程，所以提高消息入队和处理地效率是很容易的，
只要另外增加处理过程即可，不需要改变代码，也不需要调节参数。

* 削峰：在访问量剧增的情况下，应用仍然需要继续发挥作用，但是这样的突发流量并不常见。如果以能处理这类峰值为标准而投入资源，
无疑是巨大的浪费。使用消息中间件能够使关键组件支撑突发访问压力，不会因为突发的超负荷请求而完全崩溃。

* 可恢复性：当系统一部分组件失效时，不会影响整个系统。消息中间件降低了进程间的耦合度，所以即使一个处理消息的进程挂掉，
加入消息中间件中的消息仍然可以在系统恢复后进行处理。

* 顺序保证：在大多数使用场景下，数据处理的顺序是很重要的，大部分消息中间件支持一定程度上的顺序性。

* 缓冲：在任何重要的系统中，都会存在需要不同处理时间的元素。消息中间件通过一个缓冲层来帮助任务最高效率地执行，写入消息中间件
地处理会尽可能快速。该缓冲层有助于控制和优化数据流经过系统的速度。

* 异步通信：在很多时候应用不想也不需要立即处理消息。消息中间件提供了异步处理机制，允许应用把一些消息放入消息中间件中，
但并不立即处理它，在之后需要的时候再慢慢处理。


## RabbitMQ 的特点

* 可靠性：RabbitMQ 使用一些机制来保证可靠性，如持久化、传输确认及发布确认等。

* 灵活的路由：在消息进入队列之前，通过交换器路由消息。对于典型的路由功能，RabbitMQ 已经提供了一些内置的交换器来实现。
针对更复杂的路由功能，可以将多个交换器绑定到一起，也可以通过插件机制来实现自己的交换器。

* 扩展性：多个 RabbitMQ 节点可以组成一个集群，也可以根据实际业务情况动态地扩展集群中节点。

* 高可用性：队列可以在集群地机器上设置镜像，也可以根据实际业务情况动态地扩展集群中节点。

* 多种协议：RabbitMQ 除了原生支持 AMQP 协议，还支持 STOMP、MQTT 等多种消息中间件协议。

* 多种语言客户端：RabbitMQ 几乎支持所有常用语言，比如 Java、Python、Ruby、PHP、C#、JavaScript 等。

* 管理界面：RabbitMQ 提供了一个易用的用户界面，使得用户可以监控和管理消息、集群中的节点等。

* 插件机制：RabbitMQ 提供了许多插件，以实现从多方面进行扩展，当然也可以编写自己的插件。

